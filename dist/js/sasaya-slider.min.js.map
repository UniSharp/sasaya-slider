{"version":3,"sources":["sasaya-slider.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_typeof","Symbol","iterator","obj","constructor","prototype","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","$","NAME","DATA_KEY","JQUERY_NO_CONFLICT","fn","TRANSITION_DURATION","DEFAULTS","pc","interval","list","position","showCount","mobile","SasayaSlider","$el","opts","this","init","value","_this","busy","active","currentDevice","getDevice","lastDevice","$main","find","$list","addClass","appendTo","Error","append","eq","clone","$slides","$thumbs","thumbHeight","height","forEach","type","each","_","current","$current","name","fallback","$elements","first","last","direction","$target","call","data","main","makeActive","setSlidesPosition","window","resize","setTimeout","width","$element","siblings","removeClass","animate","callback","_this2","properties","left","elements","element","push","strategies","top","index","Math","min","$thumb","method","parseInt","css","apply","property","params","_this3","clearTimeout","$obj","_this4","timeout","show","_opts","extend","slider","sasayaSlider","plugin","noConflict","jQuery"],"mappings":"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","file":"sasaya-slider.min.js","sourcesContent":["'use strict';\n\n(($) => {\n  const NAME = 'sasayaSlider';\n\n  const VERSION = '0.2.0';\n\n  const DATA_KEY = 'sasaya-slider';\n\n  const JQUERY_NO_CONFLICT = $.fn[NAME];\n\n  const TRANSITION_DURATION = 800;\n\n  const DEFAULTS = {\n    pc: {\n      interval: 7000,\n      list: {\n        position: 'right',\n        showCount: 4\n      }\n    },\n    mobile: {\n      interval: 5000,\n      list: {\n        position: 'bottom',\n        showCount: 2\n      }\n    }\n  };\n\n  class SasayaSlider {\n    constructor($el, opts) {\n      this.$el = $el;\n      this.opts = opts;\n\n      this.init();\n    }\n\n    init() {\n      this.busy = false;\n      this.active = {};\n\n      this.currentDevice = this.getDevice();\n      this.lastDevice = this.currentDevice;\n\n      this.$main = this.$el.find('.main');\n      this.$list = $('<div>').addClass('list').appendTo(this.$el);\n\n      if (!this.$main.find('.item').length) {\n        throw new Error('No slide.');\n      }\n\n      // 最少要有 6 個\n      for (let i = 0; this.$main.find('.item').length < this.opts.pc.list.showCount + 2; i++) {\n        this.$main.append(this.$main.find('.item').eq(i).clone());\n      }\n\n      this.$slides = this.$main.find('.item');\n\n      // 建立 thumbs\n      this.$slides.clone(true).appendTo(this.$list);\n      this.$thumbs = this.$list.find('.item');\n      this.thumbHeight = this.$main.height() / this.opts.pc.list.showCount;\n\n      // 初始 chain\n      ['$slides', '$thumbs'].forEach((type) => {\n        this[type].each((_, current) => {\n          let $current = $(current);\n          [{\n            name: 'next',\n            fallback: ($elements) => {\n              return $elements.first();\n            }\n          }, {\n            name: 'prev',\n            fallback: ($elements) => {\n              return $elements.last();\n            }\n          }].forEach((direction) => {\n            let $target = $current[direction.name].call($current);\n\n            if (!$target.length) {\n              $target = direction.fallback.call(this[type], this[type]);\n            }\n\n            $current.data(direction.name, $target);\n          });\n        });\n      });\n\n      // 設定 active\n      this.active.main = this.$slides.first();\n      this.active.list = this.$thumbs.eq(1);\n      this.makeActive();\n\n      // 初始 slide 位置\n      this.setSlidesPosition();\n\n      // 註冊事件\n      $(window).resize(() => {\n        this.currentDevice = this.getDevice();\n\n        if (this.currentDevice != this.lastDevice) {\n          this.lastDevice = this.currentDevice;\n          this.setSlidesPosition();\n        }\n      });\n\n      // 開始輪播\n      this.setTimeout();\n    }\n\n    getDevice() {\n      return $(window).width() <= 768 ? 'mobile' : 'pc';\n    }\n\n    makeActive() {\n      $.each(this.active, (_, $element) => {\n        $element.addClass('active').siblings().removeClass('active');\n      });\n    }\n\n    setSlidesPosition(animate, callback) {\n      [{\n        properties: { left: '-100%' },\n        elements: this.active.main.data('prev')\n      }, {\n        properties: { left: 0 },\n        elements: this.active.main\n      }, {\n        properties: { left: '100%' },\n        elements: (() => {\n          let elements = [];\n\n          this.active.main.siblings().each((_, element) => {\n            if (element === this.active.main.data('prev')[0]) {\n              return;\n            }\n\n            elements.push(element);\n          });\n\n          return $(elements);\n        })()\n      }, {\n        properties: (() => {\n          let strategies = {\n            pc: {\n              top: () => {\n                return (this.thumbHeight  * -1) + 'px';\n              },\n              left: 0\n            },\n            mobile: {\n              top: 0,\n              left: () => {\n                return (100 / this.opts.mobile.list.showCount * -1) + '%';\n              }\n            }\n          }\n\n          return strategies[this.currentDevice];\n        })(),\n        elements: this.active.list.data('prev')\n      }, {\n        properties: (() => {\n          let strategies = {\n            pc: {\n              top: (index) => {\n                return (\n                  this.thumbHeight *\n                  Math.min(index, this.opts.pc.list.showCount)\n                ) + 'px';\n              },\n              left: 0\n            },\n            mobile: {\n              top: 0,\n              left: (index) => {\n                return (\n                  (100 / this.opts.mobile.list.showCount) *\n                  Math.min(index, this.opts.mobile.list.showCount)\n                ) + '%';\n              }\n            }\n          };\n\n          return strategies[this.currentDevice];\n        })(),\n        elements: (() => {\n          let elements = [];\n\n          for (\n            let i = 0, $thumb = this.active.list;\n            i < this.$thumbs.length - 1;\n            i++, $thumb = $thumb.data('next')\n          ) {\n            elements.push($thumb);\n          }\n\n          return $(elements);\n        })()\n      }].forEach((position) => {\n        position.elements.each((index, element) => {\n          $.each(position.properties, (key, value) => {\n            let method = animate ? 'animate' : 'css';\n            let current = parseInt($(element).css(key));\n\n            if ('function' === typeof value) {\n              value = value.call(element, index, element);\n            }\n\n            if (\n              'animate' === method &&\n              0 === current && 0 === value || (\n                0 !== current && 0 !== value &&\n                (current < 0 && parseInt(value) > 0) ||\n                (current > 0 && parseInt(value) < 0)\n              )\n            ) {\n              method = 'css';\n            }\n\n            $(element)[method].apply($(element), (() =>{\n              let property = {};\n              let params = [];\n\n              property[key] = value;\n              params.push(property);\n\n              if ('animate' === method) {\n                params.push(TRANSITION_DURATION);\n              }\n\n              return params;\n            })());\n          });\n        });\n      });\n\n      if ('function' === typeof callback) {\n        window.setTimeout(() => {\n          callback.call(this);\n        }, animate ? TRANSITION_DURATION : 1);\n      }\n    }\n\n    show(method) {\n      if (this.busy) {\n        return;\n      }\n\n      this.busy = true;\n\n      this.clearTimeout();\n\n      $.each(this.active, (key, $obj) => {\n        this.active[key] = $obj.data(method);\n      });\n\n      this.setSlidesPosition(true, () => {\n        this.makeActive();\n\n        this.setTimeout();\n\n        this.busy = false;\n      });\n    }\n\n    setTimeout() {\n      if (this.timeout) {\n        this.clearTimeout();\n      }\n\n      this.timeout = window.setTimeout(() => {\n        this.show('next');\n      }, this.opts[this.currentDevice].interval);\n    }\n\n    clearTimeout() {\n      window.clearTimeout(this.timeout);\n    }\n\n    static plugin(opts) {\n      let _opts = $.extend({}, DEFAULTS, 'object' === typeof opts ? opts : {});\n\n      return this.each((_, element) => {\n        let $element = $(element);\n        let slider = $element.data(DATA_KEY);\n\n        if (!slider) {\n          $element.data(DATA_KEY, slider = new SasayaSlider($element, _opts));\n        }\n\n        if ('string' === typeof opts) {\n          switch (opts) {\n            case 'prev':\n            case 'next':\n              slider.show(opts);\n              break;\n\n            default:\n              throw new Error('Method [' + opts + '] not found.');\n          }\n        }\n      });\n    }\n  }\n\n  $.fn.sasayaSlider = SasayaSlider.plugin;\n  $.fn.sasayaSlider.Constructor = SasayaSlider;\n\n  $.fn.sasayaSlider.noConflict = () => {\n    $.fn.sasayaSlider = JQUERY_NO_CONFLICT;\n\n    return SasayaSlider.plugin;\n  };\n})(jQuery);\n"]}